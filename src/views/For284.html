<style>
    .btn-print,
    .accordion {
        display: inline-block;
    }

    @media print {
        #RegistrosTablaFOR tbody tr:nth-child(14n+1) {
            page-break-before: always;
        }

        #RegistrosTablaFOR tbody tr:not(:nth-child(14n+1)) {
            page-break-inside: avoid;
        }
    }

    @media print {
        .contact-form {
            margin-left: 5% !important;
            margin-right: 5% !important;
            width: 90% !important;
            max-width: none !important;
        }
    }

    @media print {

        /* Define el tamaño de la página */
        @page {
            size: A4 portrait;
        }

        /* Define el tamaño de fuente */
        body {
            font-size: 14px;
        }
    }

    @media print {
        .no-print {
            display: none;
        }
    }

    @media print {
        .si-print {
            display: block !important;
        }
    }
</style>




<div class="container contact-form ">
    <div class="no-print">




        <h3 style="margin-top: 2%" id="titulos">Imprimir Formulario FOR-CNSP-284</h3>
        <div class="responsive">
            <div style="margin-top:-3%; margin-left: 7% " class="row d-flex justify-content-center ">

                <div style="zoom: 80%" class="col-md-3">
                    <div class="form-floating mb-5 ">
                        <select type="text" name="sede" id="sede" class="form-select" data-placeholder="" required>
                            <option value="ROM JESÚS MARÍA" selected>ROM JESÚS MARÍA</option>
                            <option value="ROM CHORRILLOS">ROM CHORRILLOS</option>
                            <option value="ROM COVID-19">ROM COVID-19</option>
                        </select>
                        <label for="sede">Sede: </label>
                    </div>
                </div>

                <div style="zoom: 80%" class="col-md-2">
                    <div class="form-floating mb-5 ">
                        <input type="date" name="fechaInicio" id="fechaInicio" class="form-control"
                            onchange="mostrarFechaSeleccionada()" data-placeholder="" required>
                        <label for="fechaInicio">Fecha: </label>
                    </div>
                </div>
                <div class="col-md-2">
                    <button id="buttonBuscarConsulta" style="zoom: 90%" type="button" class="btn btn-primary btn-lg"
                        onclick="buscarRegistrosBusquedaFOR284()">Buscar</button>
                    <button id="buttonBuscarLoadingC" style="zoom: 90%" class="btn btn-primary btn-lg" type="button"
                        hidden disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Cargando...
                    </button>
                </div>
            </div>
        </div>


        <div class="responsive">
            <div lass="row">

                <button style="zoom: 80%" type="button" class="btn btn-warning btn-lg btn-print"
                    onclick="window.print()"><svg style="zoom: 150%" xmlns="http://www.w3.org/2000/svg" width="16"
                        height="16" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">
                        <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z" />
                        <path
                            d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z" />
                    </svg> Vista previa de impresión</button>

                <div style="margin-left: 1%; margin-top: -2%; zoom: 78%" class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h1 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                Más ajustes de impresión!
                            </button>
                        </h1>
                        <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <p class="mb-0">Tamaño de papel: "A4"</p>
                                <p class="mb-0">Márgenes: "Ninguno"</p>
                                <p class="mb-0">Escala: "Perzonalizado (60%)"</p>
                                <p class="mb-0">Gráficos de fondo: "No"</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


    </div>

    <div class="table-responsive">

        <table style="width:100%; text-align:center; border: none" id="RegistrosTablaFOR" class="table table-bordered">
            <thead class="table">

                <div class="si-print">
                    <tr style="border-top: 2px solid transparent; border-bottom: 2px solid transparent; border-left: 2px solid transparent; border-right: 2px solid transparent; color: transparent"
                        class="si-print" hidden>
                        <th colspan="8" style="font-size: 18px; background-color: transparent">.</th>
                    </tr>
                    <tr
                        style="border-top: 2px solid transparent; border-left: 2px solid transparent; border-right: 2px solid transparent; color: transparent">
                        <th colspan="8" style="font-size: 18px; background-color: transparent">.</th>
                    </tr>
                </div>

                <div class="si-print">
                    <tr style="color: #222222; border: 2px solid #000000; vertical-align: middle">
                        <th style="width: 17%; border: 2px solid #000000" rowspan="2"><img
                                src="https://elfirmedelasalud.ins.gob.pe/wp-content/uploads/2022/08/logo-ins.png"
                                style="max-width: 130px; height: 130px; margin: 0px; width: 130px;"></th>
                        <th colspan="8" style="border: 2px solid #000000; font-size: 20px">FORMULARIO</th>
                        <th style="border: 2px solid #000000; width: 19%; font-size: 20px" colspan="1">FOR-CNSP-284</th>

                    </tr>
                    <tr style="color: #222222; border: 2px solid #000000; vertical-align: middle">
                        <th colspan="8" style="border: 2px solid #000000; font-size: 20px">REGISTRO DE RECEPCIÓN DE
                            MUESTRAS</th>
                        <th style="border: 2px solid #000000; width: 19%; font-size: 20px">Edición N° 02</th>
                    </tr>
                </div>

                <div class="si-print">
                    <tr
                        style="border-right: 2px solid transparent; background-color: transparent; border: none; vertical-align: middle">
                        <th colspan="9"
                            style="font-size: 18px; background-color: transparent; border-right: 2px solid transparent; border-left: 2px solid transparent">

                            <div style="text-align: right"><span style="zoom:92%; color: #222222">Fecha:</span><input
                                    class="form-date__input2" type="date" id="fecha"
                                    style="color: #222222; font-weight: bold; zoom: 90%" disabled></input></div>

                        </th>
                    </tr>
                </div>


                <tr style="border: 2px solid #000000; color: #222222; vertical-align: middle">
                    <th style="border: 2px solid #000000" colspan="2" rowspan="2">PROCEDENCIA<br>(Indicar lugar y número
                        de oficio)</th>
                    <th style="border: 2px solid #000000" rowspan="2">TIPO DE ENVÍO</th>
                    <th style="border: 2px solid #000000" colspan="2">MUESTRAS</th>
                    <th style="border: 2px solid #000000" colspan="1">FICHAS</th>
                    <th style="border: 2px solid #000000" rowspan="2">T°</th>
                    <th style="border: 2px solid #000000" rowspan="2">ENFERMEDAD</th>
                    <th style="border: 2px solid #000000" rowspan="2">HORA DE LLEGADA</th>
                    <th style="border: 2px solid #000000" rowspan="2">OBSERVACIONES</th>

                </tr>
                <tr style="border: 2px solid #000000; color: #222222; vertical-align: middle">
                    <th style="border: 2px solid #000000">CANT.</th>
                    <th style="border: 2px solid #000000">TIPO</th>
                    <th style="border: 2px solid #000000">CANT.</th>
                </tr>
            </thead>
            <tbody style="border: 2px solid #000000" id="RegistrosTablaBody">
            </tbody>
        </table>



    </div>

    <template id="registrosRow">
        <tr height="90" style="color: #222222">
            <td colspan="2" style="border: 2px solid #000000; vertical-align: middle" class="registro1"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro2"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro3"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro4"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro4-1"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro5"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro6"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro7"></td>
            <td style="border: 2px solid #000000; vertical-align: middle" class="registro8"></td>



        </tr>
    </template>
    </br>

</div>





<script>

    n = 480
    var l = document.getElementById("number");
    var id = window.setInterval(function () {
        document.onmousemove = function () {
            n = 480
        };
        l.innerText = n;
        n--;

        const alertCerrarSesion = document.getElementById("alertCerrarSesion");
        if (n > 60) {
            alertCerrarSesion.hidden = true;
        } if (n <= 60 && n > -1) {
            alertCerrarSesion.hidden = false;
        } if (n <= -1) {
            const crearModal = bootstrap.Modal.getOrCreateInstance("#staticBackdrop");
            crearModal.show();
            alertCerrarSesion.hidden = true;
            clearInterval(id);
        }

    }, 1000);

    function mostrarFechaSeleccionada() {
        var fecha = document.getElementById("fecha");
        var fechaInicio = document.getElementById("fechaInicio").value;
        document.getElementById("fecha").value = fechaInicio;
    }





    const spinnerBusq = document.getElementById("buttonBuscarConsulta");
    const spinnerLoadBusq = document.getElementById("buttonBuscarLoadingC");

    spinnerBusq.addEventListener("click", cargarEnvio);

    function cargarEnvio(e) {
        console.log(e);
        spinnerBusq.hidden = true;
        spinnerLoadBusq.hidden = false;
    }



</script>